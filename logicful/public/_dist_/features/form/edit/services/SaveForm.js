import{postApi as s,putApi as n}from"../../../../services/ApiService.js";import a from"../../../../store/FormStore.js";import{fastClone as r}from"../../../../util/Compare.js";import{dispatch as c}from"../../../../event/EventBus.js";export async function saveForm(e={dispatchEvent:!0},t){t||(t=a.getForm());const i=r(t);if(o(i),await u(i),saveToLocalStorage(i),!e.dispatchEvent)return;c("form_saved",t)}export function saveToLocalStorage(e){let t=r(e);t=o(t),localStorage.setItem("form",JSON.stringify(t))}const p=["block"];function o(e){return e.fields&&(e.fields=e.fields.map(t=>(p.includes(t.type)||delete t.value,t))),e}async function u(e){return await(e.id?n(`form/${e.id}`,e):s("form",e))}
