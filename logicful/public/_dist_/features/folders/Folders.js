import{SvelteComponent as q,append as g,attr as m,check_outros as I,create_component as C,destroy_component as S,detach as $,element as p,group_outros as E,init as H,insert as N,listen as M,mount_component as L,safe_not_equal as P,set_input_value as x,space as k,text as z,transition_in as v,transition_out as y}from"../../../web_modules/svelte/internal.js";import{dispatch as B,subscribe as G,subscribeComponent as A}from"../../event/EventBus.js";import"../../../web_modules/svelte-routing.js";import{LoadState as h}from"../../models/LoadState.js";import{postApi as J}from"../../services/ApiService.js";import{me as K}from"../../services/AuthService.js";import{onMount as Q}from"../../../web_modules/svelte.js";import R from"../../components/layout/Dialog.js";import"../../components/Loader.js";import"../../components/Link.js";import T from"./FolderList.js";import{getFolders as U}from"./FolderService.js";import V from"../../components/Button.js";function D(a){let l,t;return l=new R({props:{title:"Create New Folder",isOpen:!0,actions:[{label:"Create Folder",type:"secondary",onClick:a[6]},{label:"Cancel",type:"danger"}],onClose:a[8],$$slots:{default:[W]},$$scope:{ctx:a}}}),{c(){C(l.$$.fragment)},m(e,n){L(l,e,n),t=!0},p(e,n){const d={};n&4&&(d.onClose=e[8]),n&32776&&(d.$$scope={dirty:n,ctx:e}),l.$set(d)},i(e){if(t)return;v(l.$$.fragment,e),t=!0},o(e){y(l.$$.fragment,e),t=!1},d(e){S(l,e)}}}function W(a){let l,t,e,n,d;return{c(){l=p("h6"),l.textContent="Folder Name",t=k(),e=p("input"),m(e,"class","form-control"),m(e,"type","text"),m(e,"id","folderName"),m(e,"name","folderName"),m(e,"placeholder","")},m(s,i){N(s,l,i),N(s,t,i),N(s,e,i),x(e,a[3]),n||(d=M(e,"input",a[7]),n=!0)},p(s,i){i&8&&e.value!==s[3]&&x(e,s[3])},d(s){s&&$(l),s&&$(t),s&&$(e),n=!1,d()}}}function X(a){let l;return{c(){l=z("+ New Form")},m(t,e){N(t,l,e)},d(t){t&&$(l)}}}function Y(a){let l,t,e,n,d,s,i,w,_,c,F,r=a[2]&&D(a);return i=new V({props:{type:"primary",width:"full",href:"/form/create",$$slots:{default:[X]},$$scope:{ctx:a}}}),c=new T({props:{onNewFolder:a[5],onSelected:a[4],folders:a[1],selected:a[0]?.id}}),{c(){r&&r.c(),l=k(),t=p("div"),e=p("div"),n=p("nav"),d=p("div"),s=p("span"),C(i.$$.fragment),w=k(),_=p("div"),C(c.$$.fragment),m(s,"class","inline-flex rounded-md shadow-sm"),m(d,"class",`mb-2 flex flex-col space-y-3 sm:space-y-0 sm:space-x-3 sm:flex-row
          xl:flex-col xl:space-x-0 xl:space-y-3`),m(n,"class","flex-1 px-2 bg-white"),m(e,"class","flex-grow flex flex-col"),m(t,"class",`flex flex-col flex-grow border-r border-gray-200 pb-4 pt-2 bg-white
    overflow-y-auto`)},m(o,f){r&&r.m(o,f),N(o,l,f),N(o,t,f),g(t,e),g(e,n),g(n,d),g(d,s),L(i,s,null),g(n,w),g(n,_),L(c,_,null),F=!0},p(o,[f]){o[2]?r?(r.p(o,f),f&4&&v(r,1)):(r=D(o),r.c(),v(r,1),r.m(l.parentNode,l)):r&&(E(),y(r,1,1,()=>{r=null}),I());const j={};f&32768&&(j.$$scope={dirty:f,ctx:o}),i.$set(j);const b={};f&2&&(b.folders=o[1]),f&1&&(b.selected=o[0]?.id),c.$set(b)},i(o){if(F)return;v(r),v(i.$$.fragment,o),v(c.$$.fragment,o),F=!0},o(o){y(r),y(i.$$.fragment,o),y(c.$$.fragment,o),F=!1},d(o){r&&r.d(o),o&&$(l),o&&$(t),S(i),S(c)}}}let ge="Search for a form",$e="";function Z(a,l,t){let e,n={},d=!1,s="",i,w=h.NotStarted,_=!1,c="";async function F(){_&&e&&B("folder_selected",{folder:e})}A("folder_deleted",async u=>{w=h.Loading,await r()}),A("folder_updated",async u=>{w=h.Loading,await r(),o(u)}),Q(async()=>{i=await K(),w=h.Loading,G("folder_content_loaded",()=>{_=!0}),await r()});async function r(u=!0){t(1,n=await U(u)),o(n[Object.keys(n)[0]]),w=h.Finished}function o(u){t(0,e=u),F()}function f(u=""){c=u,t(2,d=!0)}async function j(){await J("folder",{name:s,teamId:i.teamId,parent:c}),t(3,s=""),await r(!1),B("folder_created",c)}function b(){s=this.value,t(3,s)}const O=()=>{t(2,d=!1)};return[e,n,d,s,o,f,j,b,O]}class ee extends q{constructor(a){super();H(this,a,Z,Y,P,{})}}export default ee;
