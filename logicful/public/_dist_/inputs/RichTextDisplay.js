import{HtmlTag as y,SvelteComponent as g,attr as k,detach as f,element as m,empty as w,init as F,insert as a,noop as p,safe_not_equal as S,space as j}from"../../web_modules/svelte/internal.js";import{subscribeFieldChange as x}from"../event/FieldEvent.js";import{onMount as b}from"../../web_modules/svelte.js";import P from"../store/FormStore.js";import{isString as C}from"../guards/Guard.js";import{LoadState as c}from"../models/LoadState.js";function L(o){let e;return{c(){e=m("div"),e.innerHTML='<div class="spinner-border text-dark" role="status"><span class="sr-only">Loading...</span></div>',k(e,"class","d-flex justify-content-center")},m(t,i){a(t,e,i)},p,d(t){t&&f(e)}}}function T(o){let e;return{c(){e=m("p"),e.textContent="Failed to load content."},m(t,i){a(t,e,i)},p,d(t){t&&f(e)}}}function R(o){let e,t;return{c(){t=w(),e=new y(t)},m(i,l){e.m(o[1],i,l),a(i,t,l)},p(i,l){l&2&&e.p(i[1])},d(i){i&&f(t),i&&e.d()}}}function D(o){let e,t,i;return{c(){e=m("h5"),e.textContent="Content Placeholder",t=j(),i=m("p"),i.textContent="From the field configuration settings, select a content block to display."},m(l,n){a(l,e,n),a(l,t,n),a(l,i,n)},p,d(l){l&&f(e),l&&f(t),l&&f(i)}}}function H(o){let e;function t(n,s){return n[0]&&(n[1]===""||n[1]==null)?D:n[2]===c.Finished?R:n[2]===c.Failed?T:L}let i=t(o,-1),l=i(o);return{c(){e=m("div"),l.c()},m(n,s){a(n,e,s),l.m(e,null)},p(n,[s]){i===(i=t(n,s))&&l?l.p(n,s):(l.d(1),l=i(n),l&&(l.c(),l.m(e,null)))},i:p,o:p,d(n){n&&f(e),l.d()}}}function M(o,e,t){let{field:i}=e,{isPreview:l=!1}=e,n="",s="",u=c.NotStarted,d;x(b,r=>{r.id===i.id&&s!==r.value&&(d=r.value,v(d))}),b(async()=>{d=P.getValue(i.configTarget??i.id),console.log("URL",d),v(d)});async function v(r){t(2,u=c.Loading);try{if(!r)return;if(!C(r))return;if(r.startsWith("http")){s=r;const _=await fetch(r),h=await _.text();t(1,n=h??"")}else t(1,n=r)}catch(_){t(2,u=c.Failed)}finally{u!==c.Failed&&t(2,u=c.Finished)}}return o.$$set=r=>{"field"in r&&t(3,i=r.field),"isPreview"in r&&t(0,l=r.isPreview)},[l,n,u,i]}class U extends g{constructor(o){super();F(this,o,M,H,S,{field:3,isPreview:0})}}export default U;
