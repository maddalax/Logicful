import{SvelteComponent as z,append as h,attr as d,binding_callbacks as B,bubble as j,create_component as H,destroy_component as E,detach as M,element as g,init as I,insert as S,listen as _,mount_component as O,prevent_default as y,run_all as L,safe_not_equal as T,space as F,stop_propagation as v,transition_in as q,transition_out as A}from"../../web_modules/svelte/internal.js";import{subscribeFieldChange as D}from"../event/FieldEvent.js";import N from"./Label.js";import{afterUpdate as V,onMount as x}from"../../web_modules/svelte.js";import C from"../store/FormStore.js";import{firstNotEmpty as U}from"../util/Format.js";function G(n){let t,e,l,s,i,f,u;return{c(){t=g("div"),e=g("input"),s=F(),i=g("button"),i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z"></path></svg> 
        <span class="ml-2">Clear</span>`,d(e,"type","text"),e.value=n[2],e.readOnly=!0,d(e,"id",l=`${n[0].id}-file-input`),e.disabled=!0,d(e,"class",`form-input block w-full rounded-none rounded-l-md transition
          ease-in-out duration-150 sm:text-sm sm:leading-5`),d(i,"class",`-ml-px relative inline-flex items-center px-4 py-2 border
          border-gray-300 text-sm leading-5 font-medium rounded-r-md
          text-gray-700 bg-gray-50 hover:text-gray-500 hover:bg-white
          focus:outline-none focus:shadow-outline-indigo focus:border-indigo-300
          active:bg-gray-100 active:text-gray-700 transition ease-in-out
          duration-150`),d(t,"class","mt-1 flex rounded-md shadow-sm")},m(o,c){S(o,t,c),h(t,e),h(t,s),h(t,i),f||(u=[_(e,"click",v(y(n[8]))),_(i,"click",v(y(n[6])))],f=!0)},p(o,c){c&4&&e.value!==o[2]&&(e.value=o[2]),c&1&&l!==(l=`${o[0].id}-file-input`)&&d(e,"id",l)},d(o){o&&M(t),f=!1,L(u)}}}function J(n){let t,e,l,s,i,f,u;return{c(){t=g("div"),e=g("input"),s=F(),i=g("button"),i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="w-5 h-5" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> 
        <span class="ml-2">Browse</span>`,d(e,"type","text"),d(e,"placeholder",n[2]),d(e,"id",l=`${n[0].id}-file-input`),e.readOnly=!0,d(e,"class",`form-input block w-full rounded-none rounded-l-md transition
          ease-in-out duration-150 sm:text-sm sm:leading-5`),d(i,"class",`-ml-px relative inline-flex items-center px-4 py-2 border
          border-gray-300 text-sm leading-5 font-medium rounded-r-md
          text-gray-700 bg-gray-50 hover:text-gray-500 hover:bg-white
          focus:outline-none focus:shadow-outline-indigo focus:border-indigo-300
          active:bg-gray-100 active:text-gray-700 transition ease-in-out
          duration-150`),d(t,"class","mt-1 flex rounded-md shadow-sm")},m(o,c){S(o,t,c),h(t,e),h(t,s),h(t,i),f||(u=[_(e,"click",v(y(n[5]))),_(i,"click",v(y(n[5]))),_(t,"click",v(n[7]))],f=!0)},p(o,c){c&4&&d(e,"placeholder",o[2]),c&1&&l!==(l=`${o[0].id}-file-input`)&&d(e,"id",l)},d(o){o&&M(t),f=!1,L(u)}}}function K(n){let t,e,l,s,i,f,u,o,c;i=new N({props:{field:n[0]}});function k(a,m){return a[3]?G:J}let b=k(n,-1),p=b(n);return{c(){t=g("div"),e=g("input"),s=F(),H(i.$$.fragment),f=F(),p.c(),d(e,"type","file"),d(e,"placeholder",n[2]),d(e,"id",l=`${n[0].id}-file-input`),d(e,"class","hidden")},m(a,m){S(a,t,m),h(t,e),n[10](e),h(t,s),O(i,t,null),h(t,f),p.m(t,null),u=!0,o||(c=[_(e,"change",n[11]),_(e,"click",v(n[9]))],o=!0)},p(a,[m]){(!u||m&4)&&d(e,"placeholder",a[2]),(!u||m&1&&l!==(l=`${a[0].id}-file-input`))&&d(e,"id",l);const w={};m&1&&(w.field=a[0]),i.$set(w),b===(b=k(a,m))&&p?p.p(a,m):(p.d(1),p=b(a),p&&(p.c(),p.m(t,null)))},i(a){if(u)return;q(i.$$.fragment,a),u=!0},o(a){A(i.$$.fragment,a),u=!1},d(a){a&&M(t),n[10](null),E(i),p.d(),o=!1,L(c)}}}function P(n,t,e){let{field:l}=t,s,i="Choose a file...",f=!1,u="",o;x(()=>{e(2,i=U(l.placeholder??l.value?.name,"Choose a file..."))});function c(r){r.preventDefault(),o.click()}D(x,r=>{r.id===l.id&&e(2,i=U(l.placeholder??l.value?.name,"Choose a file..."))});function k(){s&&(e(3,f=!1),e(2,i=U(l.placeholder,"Choose a file...")),e(1,s=void 0),C.clearFile(u),e(0,l.value=void 0,l),C.set(l,{field:"value",value:void 0,fromUser:!0}))}V(()=>{if(s&&s[0]&&!f){const r=s[0];e(3,f=!0),e(2,i=r.name),u=l.id,C.setFile(u,r),e(0,l.value={name:i,id:u,size:r.size,type:r.type},l),C.set(l,{field:"value",value:l.value,fromUser:!0})}});function b(r){j(n,r)}function p(r){j(n,r)}function a(r){j(n,r)}function m(r){B[r?"unshift":"push"](()=>{o=r,e(4,o)})}function w(){s=this.files,e(1,s)}return n.$$set=r=>{"field"in r&&e(0,l=r.field)},[l,s,i,f,o,c,k,b,p,a,m,w]}class Q extends z{constructor(n){super();I(this,n,P,K,T,{field:0})}}export default Q;
