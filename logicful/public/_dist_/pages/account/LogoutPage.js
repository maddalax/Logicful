/* src/pages/account/LogoutPage.svelte generated by Svelte v3.25.1 */
import {
	SvelteComponent,
	append,
	attr,
	create_component,
	destroy_component,
	detach,
	element,
	init,
	insert,
	mount_component,
	noop,
	safe_not_equal,
	set_style,
	space,
	transition_in,
	transition_out
} from "../../../web_modules/svelte/internal.js";

import Loader from "../../components/Loader.js";
import { onMount } from "../../../web_modules/svelte.js";

function create_fragment(ctx) {
	let meta;
	let script;
	let script_src_value;
	let t0;
	let div;
	let loader;
	let t1;
	let h3;
	let current;
	loader = new Loader({});

	return {
		c() {
			meta = element("meta");
			script = element("script");
			t0 = space();
			div = element("div");
			create_component(loader.$$.fragment);
			t1 = space();
			h3 = element("h3");
			h3.textContent = "Signing out... please wait.";
			attr(meta, "name", "google-signin-client_id");
			attr(meta, "content", "507014281135-ff3semdge1t7iu6jdi63h3ido0ch4k4q.apps.googleusercontent.com");
			if (script.src !== (script_src_value = "https://apis.google.com/js/platform.js")) attr(script, "src", script_src_value);
			script.async = true;
			script.defer = true;
			set_style(div, "margin-top", "5em");
			set_style(div, "margin-left", "3em");
		},
		m(target, anchor) {
			append(document.head, meta);
			append(document.head, script);
			insert(target, t0, anchor);
			insert(target, div, anchor);
			mount_component(loader, div, null);
			append(div, t1);
			append(div, h3);
			current = true;
		},
		p: noop,
		i(local) {
			if (current) return;
			transition_in(loader.$$.fragment, local);
			current = true;
		},
		o(local) {
			transition_out(loader.$$.fragment, local);
			current = false;
		},
		d(detaching) {
			detach(meta);
			detach(script);
			if (detaching) detach(t0);
			if (detaching) detach(div);
			destroy_component(loader);
		}
	};
}

function signOut() {
	//@ts-ignore
	if (!window.gapi) {
		setTimeout(signOut, 100);
		return;
	}

	//@ts-ignore
	window.gapi.load("auth2", function () {
		//@ts-ignore
		window.gapi.auth2.init();

		//@ts-ignore
		var auth2 = window.gapi.auth2.getAuthInstance();

		setTimeout(
			() => {
				auth2.signOut().then(function () {
					localStorage.removeItem("token");
					window.location.replace("/account/login");
				});
			},
			500
		);
	});
}

function instance($$self) {
	onMount(() => {
		setTimeout(
			() => {
				signOut();
			},
			500
		);
	});

	return [];
}

class LogoutPage extends SvelteComponent {
	constructor(options) {
		super();
		init(this, options, instance, create_fragment, safe_not_equal, {});
	}
}

export default LogoutPage;